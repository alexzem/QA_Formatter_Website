function AdFeedbackCollection(e){this.qaResults=[],this.parseFeedback(e),this.isolateCommonIssues(),this.combineLikeIssues()}function AdFeedback(e){this.ads=e.ads,this.issues=e.issues}function Ad(e){this.id=e.id,this.title=e.title,this.format=e.format}function Issue(e){this.category=e.category,this.problems_issues=e.problems_issues?e.problems_issues.replace(/^Other/,""):"",e.potentialReasons?(this.potentialReasons=e.potentialReasons.replace(/(^")|(\"(?=\"))|("$)/g,""),this.potentialReasons=this.potentialReasons.replace(/\n(?=\*)/g,"<br/>"),this.potentialReasons=this.potentialReasons.replace(/\.\n/g,".<br/>"),this.potentialReasons=this.potentialReasons.replace(/\:\n/g,":<br/>"),this.potentialReasons=this.potentialReasons.replace(/;(\s?)\n/g,";<br/>")):this.potentialReasons="",this.additionalNotes=e.additionalNotes?e.additionalNotes.replace(/\s$/,""):""}function init(){setGlobalVariables(),addEventListeners()}function setGlobalVariables(){qaInput=document.getElementById("qaInput"),qaOutput=document.getElementById("qaOutput"),defaultOutput=qaOutput.innerHTML}function addEventListeners(){var e=document.getElementById("clearButton"),t=document.getElementById("selectButton");e.addEventListener("click",resetQAInputText),t.addEventListener("click",selectOutputText),qaInput.addEventListener("keyup",updateOutput),qaInput.addEventListener("blur",updateOutput),qaInput.addEventListener("paste",function(){setTimeout(updateOutput,100)})}function resetQAInputText(){setInput(""),setOutput(defaultOutput)}function checkForNewInput(){lastInput!=getInput()&&(lastInput=getInput(),updateOutput())}function getInput(){return qaInput.value}function setInput(e){qaInput.value=e}function getOutput(){var e=unescape(qaOutput.innerHTML);return e}function setOutput(e){qaOutput.innerHTML=e}function isInt(e){var t=/^\d+$/;return t.test(e)?!0:!1}function updateOutput(){if(isStringBlank(getInput()))qaOutput.innerHTML=defaultOutput;else{var e=new AdFeedbackCollection(getInput());printOutput(e)}}function isStringBlank(e){var t=/^\s+$/;return t.test(e)||0===e.length||""===e}function printOutput(e){var t=e.qaResults,s="";t.length>0&&(s="<p><span class=siteSpecification>Site Specification</span><br/>",s+="<span class=functionality>Functionality</span><br/>",s+="<span class=tracking>Tracking</span></p>");for(var n=0;n<t.length;n++){s+="<br/><p>";for(var a=0;a<t[n].ads.length;a++)s+=t[n].ads[a].id?t[n].ads[a].id+" - ":"",s+=t[n].ads[a].title,s+=t[n].ads[a].format?" ("+t[n].ads[a].format+")":"",s+="</p>";if(s+="<ul>",t[n].issues.length>0)for(var i=0;i<t[n].issues.length;i++)s+="<li class=",s+=getCategoryClass(t[n].issues[i].category),s+=">",t[n].issues[i].problems_issues.length>1&&(s+=t[n].issues[i].problems_issues),t[n].issues[i].additionalNotes&&t[n].issues[i].additionalNotes.length>1&&(t[n].issues[i].additionalNotes.length<=10?s+=" ("+t[n].issues[i].additionalNotes+")":(t[n].issues[i].problems_issues.length>1&&(s+=". "),s+=t[n].issues[i].additionalNotes)),t[n].issues[i].potentialReasons.length>1&&(s+="<br/>",s+=t[n].issues[i].potentialReasons),s+="</li>";else s+='<li>See "All Ads"</li>';s+="</ul>"}s=s.replace(/[\u201C\u201D\u201E\u201F\u2033\u2036]/g,'"'),qaOutput.innerHTML=s}function getCategoryClass(e){switch(e){case"Site Specification":return"siteSpecification";case"Functionality":return"functionality";case"Tracking":return"tracking";default:return""}}function selectText(e){var t,s;document.body.createTextRange?(t=document.body.createTextRange(),t.moveToElementText(e),t.select()):window.getSelection&&(s=window.getSelection(),t=document.createRange(),t.selectNodeContents(e),s.removeAllRanges(),s.addRange(t))}function ascendingNumericalSort(e,t){return Number(e)-Number(t)}function selectOutputText(){selectText(qaOutput)}window.Modernizr=function(e,t,s){function n(e){h.cssText=e}function a(e,t){return typeof e===t}var i,o,r,u="2.7.1",l={},c=t.documentElement,d="modernizr",p=t.createElement(d),h=p.style,f=({}.toString,{}),g=[],m=g.slice,v={}.hasOwnProperty;r=a(v,"undefined")||a(v.call,"undefined")?function(e,t){return t in e&&a(e.constructor.prototype[t],"undefined")}:function(e,t){return v.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var s=m.call(arguments,1),n=function(){if(this instanceof n){var a=function(){};a.prototype=t.prototype;var i=new a,o=t.apply(i,s.concat(m.call(arguments)));return Object(o)===o?o:i}return t.apply(e,s.concat(m.call(arguments)))};return n}),f.localstorage=function(){try{return localStorage.setItem(d,d),localStorage.removeItem(d),!0}catch(e){return!1}};for(var y in f)r(f,y)&&(o=y.toLowerCase(),l[o]=f[y](),g.push((l[o]?"":"no-")+o));return l.addTest=function(e,t){if("object"==typeof e)for(var n in e)r(e,n)&&l.addTest(n,e[n]);else{if(e=e.toLowerCase(),l[e]!==s)return l;t="function"==typeof t?t():t,"undefined"!=typeof enableClasses&&enableClasses&&(c.className+=" "+(t?"":"no-")+e),l[e]=t}return l},n(""),p=i=null,function(e,t){function s(e,t){var s=e.createElement("p"),n=e.getElementsByTagName("head")[0]||e.documentElement;return s.innerHTML="x<style>"+t+"</style>",n.insertBefore(s.lastChild,n.firstChild)}function n(){var e=y.elements;return"string"==typeof e?e.split(" "):e}function a(e){var t=v[e[g]];return t||(t={},m++,e[g]=m,v[m]=t),t}function i(e,s,n){if(s||(s=t),c)return s.createElement(e);n||(n=a(s));var i;return i=n.cache[e]?n.cache[e].cloneNode():f.test(e)?(n.cache[e]=n.createElem(e)).cloneNode():n.createElem(e),!i.canHaveChildren||h.test(e)||i.tagUrn?i:n.frag.appendChild(i)}function o(e,s){if(e||(e=t),c)return e.createDocumentFragment();s=s||a(e);for(var i=s.frag.cloneNode(),o=0,r=n(),u=r.length;u>o;o++)i.createElement(r[o]);return i}function r(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(s){return y.shivMethods?i(s,e,t):t.createElem(s)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+n().join().replace(/[\w\-]+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(y,t.frag)}function u(e){e||(e=t);var n=a(e);return y.shivCSS&&!l&&!n.hasCSS&&(n.hasCSS=!!s(e,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),c||r(e,n),e}var l,c,d="3.7.0",p=e.html5||{},h=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,f=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,g="_html5shiv",m=0,v={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",l="hidden"in e,c=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(s){l=!0,c=!0}}();var y={elements:p.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:d,shivCSS:p.shivCSS!==!1,supportsUnknownElements:c,shivMethods:p.shivMethods!==!1,type:"default",shivDocument:u,createElement:i,createDocumentFragment:o};e.html5=y,u(t)}(this,t),l._version=u,l}(this,this.document),AdFeedbackCollection.prototype.parseRawText=function(e){var t,s=/(?:\t)|(?:\n(?=[1-9]\d{6,}))/g,n=e.split(s),a=[],i=[];for(t=0;t<n.length;t++)t>0&&t%8===0&&(a.push(i),i=[]),i.push(n[t]);return a.push(i),a},AdFeedbackCollection.prototype.parseFeedback=function(e){for(var t=0,s=1,n=2,a=3,i=5,o=6,r=7,u=this.parseRawText(e),l=0;l<u.length;l++){var c=new Issue({category:u[l][a],problems_issues:u[l][i],potentialReasons:u[l][o],additionalNotes:u[l][r]});if(0===l||u[l][t]!=u[l-1][t]){var d=new Ad({id:u[l][t],title:u[l][s],format:u[l][n]});this.qaResults.push(new AdFeedback({ads:[d],issues:[c]}))}else this.qaResults[this.qaResults.length-1].insertIssue(c)}},AdFeedbackCollection.prototype.isolateCommonIssues=function(){var e=[];if(this.qaResults.length>1){for(var t=0;t<this.qaResults[0].issues.length;t++){for(var s=this.qaResults[0].issues[t],n=!0,a=0;a<this.qaResults.length;a++)this.qaResults[a].hasIssue(s)||(n=!1);n&&e.push(s)}for(var i=0;i<e.length;i++)for(var o=0;o<this.qaResults.length;o++)this.qaResults[o].removeIssue(e[i]);if(e.length>0){var r=new Ad({id:"",title:"All Ads",format:""}),u=new AdFeedback({ads:[r],issues:e});this.qaResults.unshift(u)}}},AdFeedbackCollection.prototype.combineLikeIssues=function(){for(var e=0;e<this.qaResults.length;e++)for(var t=e+1;t<this.qaResults.length;t++)this.qaResults[e].hasSameIssuesAs(this.qaResults[t])&&(this.qaResults[e].insertAd(this.qaResults[t].ads[0]),this.qaResults.splice(t,1),t--)},AdFeedback.prototype.insertAd=function(e){this.hasAd(e)||this.ads.push(e)},AdFeedback.prototype.getAdIndex=function(e){for(var t=0;t<this.ads.length;t++)if(this.ads[t].isEqualTo(e))return t;return-1},AdFeedback.prototype.hasAd=function(e){return this.getAdIndex(e)>=0?!0:!1},AdFeedback.prototype.insertIssue=function(e){this.hasIssue(e)||this.issues.push(e)},AdFeedback.prototype.getIssueIndex=function(e){for(var t=0;t<this.issues.length;t++)if(this.issues[t].isEqualTo(e))return t;return-1},AdFeedback.prototype.hasIssue=function(e){return this.getIssueIndex(e)>=0?!0:!1},AdFeedback.prototype.removeIssue=function(e){return this.hasIssue(e)?this.issues.splice(this.getIssueIndex(e),1):void 0},AdFeedback.prototype.insertIssue=function(e){this.hasIssue(e)||this.issues.push(e)},AdFeedback.prototype.hasSameIssuesAs=function(e){if(this.issues.length!=e.issues.length)return!1;for(var t=0;t<this.issues.length;t++)if(!e.hasIssue(this.issues[t]))return!1;return!0},Ad.prototype.isEqualTo=function(e){return this.id==e.id&&this.title==e.title&&this.format==e.format},Issue.prototype.isEqualTo=function(e){return this.category==e.category&&this.problems_issues==e.problems_issues&&this.potentialReasons==e.potentialReasons&&this.additionalNotes==e.additionalNotes};var qaInput,qaOutput,defaultOutput,lastInput="",checkForInputIntervalID;window.addEventListener("load",init);