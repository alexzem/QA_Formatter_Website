function setCookie(e,t,s){var i=new Date;i.setDate(i.getDate()+s);var n=escape(t)+(null==s?"":"; expires="+i.toUTCString());document.cookie=e+"="+n}function getCookie(e){var t,s,i,n=document.cookie.split(";");for(t=0;t<n.length;t++)if(s=n[t].substr(0,n[t].indexOf("=")),i=n[t].substr(n[t].indexOf("=")+1),s=s.replace(/^\s+|\s+$/g,""),s==e)return unescape(i)}function init(){setGlobalVariables(),addEventListeners()}function setGlobalVariables(){qaInput=document.getElementById("qaInput"),qaOutput=document.getElementById("qaOutput"),selectOutputButton=document.getElementById("selectOutputButton")}function addEventListeners(){qaInput.onblur=stopCheckingfForNewInput,qaInput.onfocus=startCheckingForNewInput}function startCheckingForNewInput(){checkForInputIntervalID&&clearInterval(checkForInputIntervalID),checkForInputIntervalID=setInterval(checkForNewInput,250)}function stopCheckingfForNewInput(){clearInterval(checkForInputIntervalID),updateOutput()}function checkForNewInput(){lastInput!=getInput()&&(lastInput=getInput(),updateOutput())}function getInput(){return qaInput.value}function getOutput(){var e=unescape(qaOutput.innerHTML);return e}function isInt(e){var t=/^\d+$/;return t.test(e)?!0:!1}function updateOutput(){var e=new AdFeedbackCollection(getInput());printOutput(e)}function printOutput(e){var t=e.qaResults,s="";t.length>0&&(s="<p><span class=siteSpecification>Site Specification</span><br/>",s+="<span class=functionality>Functionality</span><br/>",s+="<span class=tracking>Tracking</span></p>");for(var i=0;i<t.length;i++){s+="<br/><p>";for(var n=0;n<t[i].ads.length;n++)s+=t[i].ads[n].id?t[i].ads[n].id+" - ":"",s+=t[i].ads[n].title,s+=t[i].ads[n].format?" ("+t[i].ads[n].format+")":"",s+="</p>";if(s+="<ul>",t[i].issues.length>0)for(var a=0;a<t[i].issues.length;a++)s+="<li class=",s+=getCategoryClass(t[i].issues[a].category),s+=">",t[i].issues[a].problems_issues.length>1&&(s+=t[i].issues[a].problems_issues),t[i].issues[a].additionalNotes&&t[i].issues[a].additionalNotes.length>1&&(t[i].issues[a].additionalNotes.length<=10?s+=" ("+t[i].issues[a].additionalNotes+")":(t[i].issues[a].problems_issues.length>1&&(s+=". "),s+=t[i].issues[a].additionalNotes)),t[i].issues[a].potentialReasons.length>1&&(s+="<br/>",s+=t[i].issues[a].potentialReasons),s+="</li>";else s+='<li>See "All Ads"</li>';s+="</ul>"}s=s.replace(/[\u201C\u201D\u201E\u201F\u2033\u2036]/g,'"'),qaOutput.innerHTML=s}function getCategoryClass(e){switch(e){case"Site Specification":return"siteSpecification";case"Functionality":return"functionality";case"Tracking":return"tracking";default:return""}}function selectText(e){var t,s,i=document.getElementById(e);document.body.createTextRange?(t=document.body.createTextRange(),t.moveToElementText(i),t.select()):window.getSelection&&(s=window.getSelection(),t=document.createRange(),t.selectNodeContents(i),s.removeAllRanges(),s.addRange(t))}function ascendingNumericalSort(e,t){return Number(e)-Number(t)}function selectOutputText(){qaOutput.focus(),qaOutput.select()}function AdFeedbackCollection(e){this.qaResults=[],this.parseFeedback(e),this.isolateCommonIssues(),this.combineLikeIssues()}function AdFeedback(e){this.ads=e.ads,this.issues=e.issues}function Ad(e){this.id=e.id,this.title=e.title,this.format=e.format}function Issue(e){this.category=e.category,this.problems_issues=e.problems_issues?e.problems_issues.replace(/^Other/,""):"",e.potentialReasons?(this.potentialReasons=e.potentialReasons.replace(/(^")|(\"(?=\"))|("$)/g,""),this.potentialReasons=this.potentialReasons.replace(/\n(?=\*)/g,"<br/>"),this.potentialReasons=this.potentialReasons.replace(/\.\n/g,".<br/>"),this.potentialReasons=this.potentialReasons.replace(/\:\n/g,":<br/>"),this.potentialReasons=this.potentialReasons.replace(/;(\s?)\n/g,";<br/>")):this.potentialReasons="",this.additionalNotes=e.additionalNotes?e.additionalNotes.replace(/\s$/,""):""}var ZeroClipboard={version:"1.0.7",clients:{},moviePath:"ZeroClipboard.swf",nextId:1,$:function(e){return"string"==typeof e&&(e=document.getElementById(e)),e.addClass||(e.hide=function(){this.style.display="none"},e.show=function(){this.style.display=""},e.addClass=function(e){this.removeClass(e),this.className+=" "+e},e.removeClass=function(e){for(var t=this.className.split(/\s+/),s=-1,i=0;i<t.length;i++)t[i]==e&&(s=i,i=t.length);return s>-1&&(t.splice(s,1),this.className=t.join(" ")),this},e.hasClass=function(e){return!!this.className.match(new RegExp("\\s*"+e+"\\s*"))}),e},setMoviePath:function(e){this.moviePath=e},newClient:function(){return new ZeroClipboard.Client},dispatch:function(e,t,s){var i=this.clients[e];i&&i.receiveEvent(t,s)},register:function(e,t){this.clients[e]=t},getDOMObjectPosition:function(e,t){for(var s={left:0,top:0,width:e.width?e.width:e.offsetWidth,height:e.height?e.height:e.offsetHeight};e&&e!=t;)s.left+=e.offsetLeft,s.top+=e.offsetTop,e=e.offsetParent;return s},Client:function(e){this.handlers={},this.id=ZeroClipboard.nextId++,this.movieId="ZeroClipboardMovie_"+this.id,ZeroClipboard.register(this.id,this),e&&this.glue(e)}};ZeroClipboard.Client.prototype={id:0,ready:!1,movie:null,clipText:"",handCursorEnabled:!0,cssEffects:!0,handlers:null,zIndex:99,glue:function(e,t,s){this.domElement=ZeroClipboard.$(e),this.domElement.style.zIndex&&(this.zIndex=parseInt(this.domElement.style.zIndex,10)+1),"string"==typeof t?t=ZeroClipboard.$(t):"undefined"==typeof t&&(t=document.getElementsByTagName("body")[0]);var i=ZeroClipboard.getDOMObjectPosition(this.domElement,t);this.div=document.createElement("div");var n=this.div.style;if(n.position="absolute",n.left=""+i.left+"px",n.top=""+i.top+"px",n.width=""+i.width+"px",n.height=""+i.height+"px",n.zIndex=this.zIndex,"object"==typeof s)for(addedStyle in s)n[addedStyle]=s[addedStyle];t.appendChild(this.div),this.div.innerHTML=this.getHTML(i.width,i.height)},getHTML:function(e,t){var s="",i="id="+this.id+"&width="+e+"&height="+t;if(navigator.userAgent.match(/MSIE/)){var n=location.href.match(/^https/i)?"https://":"http://";s+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+n+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+e+'" height="'+t+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+ZeroClipboard.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+i+'"/><param name="wmode" value="transparent"/></object>'}else s+='<embed id="'+this.movieId+'" src="'+ZeroClipboard.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+e+'" height="'+t+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+i+'" wmode="transparent" />';return s},hide:function(){this.div&&(this.div.style.left="-2000px")},show:function(){this.reposition()},destroy:function(){if(this.domElement&&this.div){this.hide(),this.div.innerHTML="";var e=document.getElementsByTagName("body")[0];try{e.removeChild(this.div)}catch(t){}this.domElement=null,this.div=null}},reposition:function(e){if(e&&(this.domElement=ZeroClipboard.$(e),this.domElement||this.hide()),this.domElement&&this.div){var t=ZeroClipboard.getDOMObjectPosition(this.domElement),s=this.div.style;s.left=""+t.left+"px",s.top=""+t.top+"px"}},setText:function(e){this.clipText=e,this.ready&&this.movie.setText(e)},addEventListener:function(e,t){e=e.toString().toLowerCase().replace(/^on/,""),this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t)},setHandCursor:function(e){this.handCursorEnabled=e,this.ready&&this.movie.setHandCursor(e)},setCSSEffects:function(e){this.cssEffects=!!e},receiveEvent:function(e,t){switch(e=e.toString().toLowerCase().replace(/^on/,"")){case"load":if(this.movie=document.getElementById(this.movieId),!this.movie){var s=this;return void setTimeout(function(){s.receiveEvent("load",null)},1)}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){var s=this;return setTimeout(function(){s.receiveEvent("load",null)},100),void(this.ready=!0)}this.ready=!0,this.movie.setText(this.clipText),this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":this.domElement&&this.cssEffects&&(this.domElement.addClass("hover"),this.recoverActive&&this.domElement.addClass("active"));break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("active")&&(this.domElement.removeClass("active"),this.recoverActive=!0),this.domElement.removeClass("hover"));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("active"),this.recoverActive=!1)}if(this.handlers[e])for(var i=0,n=this.handlers[e].length;n>i;i++){var a=this.handlers[e][i];"function"==typeof a?a(this,t):"object"==typeof a&&2==a.length?a[0][a[1]](this,t):"string"==typeof a&&window[a](this,t)}}};var COOKIE_EXPIRATION_LIMIT=360,clipboard,qaInput,qaOutput,selectOutputButton,lastInput="",checkForInputIntervalID;window.onload=init,AdFeedbackCollection.prototype.parseRawText=function(e){var t,s=/(?:\t)|(?:\n(?=[1-9]\d{6,}))/g,i=e.split(s),n=[],a=[];for(t=0;t<i.length;t++)t>0&&t%8===0&&(n.push(a),a=[]),a.push(i[t]);return n.push(a),n},AdFeedbackCollection.prototype.parseFeedback=function(e){for(var t=0,s=1,i=2,n=3,a=5,o=6,r=7,l=this.parseRawText(e),u=0;u<l.length;u++){var d=new Issue({category:l[u][n],problems_issues:l[u][a],potentialReasons:l[u][o],additionalNotes:l[u][r]});if(0===u||l[u][t]!=l[u-1][t]){var h=new Ad({id:l[u][t],title:l[u][s],format:l[u][i]});this.qaResults.push(new AdFeedback({ads:[h],issues:[d]}))}else this.qaResults[this.qaResults.length-1].insertIssue(d)}},AdFeedbackCollection.prototype.isolateCommonIssues=function(){var e=[];if(this.qaResults.length>1){for(var t=0;t<this.qaResults[0].issues.length;t++){for(var s=this.qaResults[0].issues[t],i=!0,n=0;n<this.qaResults.length;n++)this.qaResults[n].hasIssue(s)||(i=!1);i&&e.push(s)}for(var a=0;a<e.length;a++)for(var o=0;o<this.qaResults.length;o++)this.qaResults[o].removeIssue(e[a]);if(e.length>0){var r=new Ad({id:"",title:"All Ads",format:""}),l=new AdFeedback({ads:[r],issues:e});this.qaResults.unshift(l)}}},AdFeedbackCollection.prototype.combineLikeIssues=function(){for(var e=0;e<this.qaResults.length;e++)for(var t=e+1;t<this.qaResults.length;t++)this.qaResults[e].hasSameIssuesAs(this.qaResults[t])&&(this.qaResults[e].insertAd(this.qaResults[t].ads[0]),this.qaResults.splice(t,1),t--)},AdFeedback.prototype.insertAd=function(e){this.hasAd(e)||this.ads.push(e)},AdFeedback.prototype.getAdIndex=function(e){for(var t=0;t<this.ads.length;t++)if(this.ads[t].isEqualTo(e))return t;return-1},AdFeedback.prototype.hasAd=function(e){return this.getAdIndex(e)>=0?!0:!1},AdFeedback.prototype.insertIssue=function(e){this.hasIssue(e)||this.issues.push(e)},AdFeedback.prototype.getIssueIndex=function(e){for(var t=0;t<this.issues.length;t++)if(this.issues[t].isEqualTo(e))return t;return-1},AdFeedback.prototype.hasIssue=function(e){return this.getIssueIndex(e)>=0?!0:!1},AdFeedback.prototype.removeIssue=function(e){return this.hasIssue(e)?this.issues.splice(this.getIssueIndex(e),1):void 0},AdFeedback.prototype.insertIssue=function(e){this.hasIssue(e)||this.issues.push(e)},AdFeedback.prototype.hasSameIssuesAs=function(e){if(this.issues.length!=e.issues.length)return!1;for(var t=0;t<this.issues.length;t++)if(!e.hasIssue(this.issues[t]))return!1;return!0},Ad.prototype.isEqualTo=function(e){return this.id==e.id&&this.title==e.title&&this.format==e.format},Issue.prototype.isEqualTo=function(e){return this.category==e.category&&this.problems_issues==e.problems_issues&&this.potentialReasons==e.potentialReasons&&this.additionalNotes==e.additionalNotes};